<!DOCTYPE html>
<html>
<head></head>
<body>  

<input id="url" type="text" value="" placeholder="url" rows="10" cols="100" style="display:block; text-align: left; width: 600px;">
	
<button id="load_tarGZ_JS_way0" onclick="load_tarGZ_JS_way0()">load_tarGZ_JS_way0</button>
<button id="load_tarGZ_JS_way1" onclick="load_tarGZ_JS_way1()">load_tarGZ_JS_way1</button>
	

<!-- --------------------------------------------------- -->	

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdn.jsdelivr.net/npm/zlib@1.0.5/index.min.js"></script>

<!-- --------------------------------------------------- -->	

<script>


// -----------------------------------------------

async function load_tarGZ_JS_way0() {

	
	const url = document.getElementById("url").value;

	// Use JavaScript to fetch tarGZ_data as an arrayBuffer
	var arrayBuffer = await call_fetch_method(url, "arrayBuffer");
	console.log("arrayBuffer: ", arrayBuffer);

	
}

// -----------------------------------------------

async function load_tarGZ_JS_way1() {
	
	const url = document.getElementById("url").value;

	// Use JavaScript to fetch tarGZ_data as a blob
	var blob = await call_fetch_method(url, "blob");
	console.log("blob: ", blob);

	// convert blob to a stream

	
	
}

// -----------------------------------------------





// -----------------------------------------------
// SUBFUNCTIONS
// -----------------------------------------------
async function call_fetch_method(url, typeOfOutput) {

	var CORS_method_list;
	if (typeOfOutput == "arrayBuffer") {
		CORS_method_list = ["jQuery_arrayBuffer_GET", "fetch_arrayBuffer_GET"];
		
	} else if (typeOfOutput == "blob") {
		CORS_method_list = ["jQuery_blob_GET", "fetch_blob_GET"];
	}
	
	var response = undefined;
		
	for (var i=0; i<CORS_method_list.length; i++) {
		try {
			if (typeOfOutput == "arrayBuffer") {
				if (i == 0) {
					response = await fetch_arrayBuffer_GET(url);
				} else {
					response = await jQuery_arrayBuffer_GET(url);
				}
			} else if (typeOfOutput == "blob") {
				if (i == 0) {
					response = await fetch_blob_GET(url);
				} else {
					response = await jQuery_blob_GET(url);
				}
			}
			
		} catch (error) {
			console.log("error: ", error);
		}
		if (response != undefined) {
			break;
		}
	}
	return response;
}

// -----------------------------------------------

async function fetch_arrayBuffer_GET(url) {
	
	var headers = {
		"Content-Type": "application/json",
		"Referer": url,
		"Origin": "https://codesolutions2.github.io",
		"Connection": "keep-alive",
		"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:120.0) Gecko/20100101 Firefox/120.0",
		"Access-Control-Allow-Origin": "*",
	};
	
	var options = { 
		method : "GET",
		mode: 'cors',
		headers: new Headers(headers),
		cache: "no-cache",
		crossorigin: 'anonymous',
		redirect: "follow"
	};
	
	return await fetch(url, options)
		.then(res => res.arrayBuffer())
		.then(arrayBuffer => { return arrayBuffer; })
		.catch(error => { console.error("error: ", error); });

}

// -----------------------------------------------

async function jQuery_arrayBuffer_GET(url) {
	
	var headers = {
		"Content-Type": "application/json",
		"Referer": url,
		"Origin": "https://codesolutions2.github.io",
		"Connection": "keep-alive",
		"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:120.0) Gecko/20100101 Firefox/120.0",
		"Access-Control-Allow-Origin": "*",
	};
	
	var settings = {
		// url: url,
		type : "GET",
		async: true,
		crossDomain: true,
		beforeSend: function(xhr) {xhr.withCredentials = true;},
		// headers: new Headers(headers),
		xhrFields: {responseType: 'arrayBuffer'},
		dataType: 'binary',
		success: function(response) { console.log('Success'); },
		error: function(xhr, status, error) { console.error("error: ", error); }
	};
	
	return $.ajax(url, [,settings]).done(function(response) { return response; });

}

// -----------------------------------------------

async function fetch_blob_GET(url) {
	
	var headers = {
		"Content-Type": "application/json",
		"Referer": url,
		"Origin": "https://codesolutions2.github.io",
		"Connection": "keep-alive",
		"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:120.0) Gecko/20100101 Firefox/120.0",
		"Access-Control-Allow-Origin": "*",
	};
	
	var options = { 
		method : "GET",
		mode: 'cors',
		headers: new Headers(headers),
		cache: "no-cache",
		crossorigin: 'anonymous',
		redirect: "follow"
	};
	
	return await fetch(url, options)
		.then(res => res.blob())
		.then(blob_object => { return blob_object; })
		.catch(error => { console.error("error: ", error); });

}

// -----------------------------------------------

async function jQuery_blob_GET(url) {
	
	var headers = {
		"Content-Type": "application/json",
		"Referer": url,
		"Origin": "https://codesolutions2.github.io",
		"Connection": "keep-alive",
		"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:120.0) Gecko/20100101 Firefox/120.0",
		"Access-Control-Allow-Origin": "*",
	};
	
	var settings = {
		// url: url,
		type : "GET",
		async: true,
		crossDomain: true,
		beforeSend: function(xhr) {xhr.withCredentials = true;},
		// headers: new Headers(headers),
		xhrFields: {responseType: 'blob'},
		dataType: 'binary',
		success: function(response) { console.log('Success'); },
		error: function(xhr, status, error) { console.error("error: ", error); }
	};
	
	return $.ajax(url, [,settings]).done(function(response) { return response; });

}

// -----------------------------------------------



	


</script>
</body>
</html>
